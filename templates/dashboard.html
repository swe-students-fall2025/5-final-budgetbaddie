{% extends "base.html" %}
{% block content %}

<h2>Hello, {{ user.email }}</h2>

<!-- 以后放 graphs&lists -->

<div id="budget-modal" class="modal {% if need_budget_popup %}show{% endif %}">
  <div class="modal-content">
    <h3>Set your budget for {{ current_month }}/{{ current_year }}</h3>
    <form method="POST" action="{{ url_for('save_budget_plan') }}">
      <input type="hidden" name="year" value="{{ current_year }}">
      <input type="hidden" name="month" value="{{ current_month }}">

      <label>Total monthly budget</label>
      <input type="number" step="0.01" name="total_budget" required>

      <button type="submit">Save</button>
    </form>
  </div>
</div>

<!--check-->>
<section class="add-expense">
  <h3>Add Expense</h3>
  <form method="POST" action="{{ url_for('add_expense') }}">
    <label>Date</label>
    <input type="date" name="date" required>

    <label>Category</label>
    <input type="text" name="category" required>

    <label>Amount</label>
    <input type="number" step="0.01" name="amount" required>

    <label>
      <input type="checkbox" name="is_recurring">
      Recurring
    </label>

    <button type="submit">Add</button>
  </form>
</section>

<section class="expense-list">
  <h3>This Month's Expenses</h3>
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Category</th>
        <th>Amount</th>
        <th>Recurring</th>
      </tr>
    </thead>
    <tbody>
      {% for e in expenses %}
      <tr>
        <td>{{ e.date.strftime('%Y-%m-%d') if e.date else '' }}</td>
        <td>{{ e.category }}</td>
        <td>{{ '%.2f'|format(e.amount) }}</td>
        <td>{{ 'Yes' if e.is_recurring else 'No' }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</section>


{% endblock %}
